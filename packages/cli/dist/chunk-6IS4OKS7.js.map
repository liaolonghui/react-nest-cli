{"version":3,"sources":["../src/commands/base/init.ts"],"sourcesContent":["import type { Command } from 'commander'\nimport prompts from 'prompts'\nimport promptsConfig from '../../configs/prompts.config.ts'\nimport consola from 'consola'\nimport fsExtra from 'fs-extra'\nimport path from 'node:path'\nimport { cwd } from 'node:process'\nimport { downloadTemplate } from 'giget'\nimport ora from 'ora'\n\nexport default function init(program: Command) {\n    program\n        .command('init')\n        .description('åˆå§‹åŒ–é¡¹ç›®')\n        .argument('[project-name]', 'é¡¹ç›®åç§°')\n        .option('--template <template-name>', 'é¡¹ç›®æ¨¡æ¿åç§°')\n        .action(async (projectName, rest) => {\n            let { template } = rest || {}\n            // å¦‚æœprojectNameæ²¡æœ‰æä¾›ï¼Œè®©ç”¨æˆ·è¾“å…¥\n            if (!projectName) {\n                const response = await prompts({\n                    type: 'text',\n                    initial: 'my-project', // é»˜è®¤å€¼\n                    name: 'projectName',\n                    message: 'è¯·è¾“å…¥é¡¹ç›®åç§°',\n                    // validate: value => value.length ? true : 'è¯·è¾“å…¥é¡¹ç›®åç§°'\n                })\n                projectName = response.projectName\n            }\n\n            // å¦‚æœtemplateæ²¡æœ‰æä¾›æˆ–è€…templateä¸å­˜åœ¨ï¼Œè®©ç”¨æˆ·é€‰æ‹©\n            const noTemplate =\n                template &&\n                !promptsConfig.templates.find((item) => item.value === template)\n            if (!template || noTemplate) {\n                if (noTemplate) {\n                    consola.error(`é¡¹ç›®æ¨¡æ¿ ${template} ä¸å­˜åœ¨, è¯·é€‰æ‹©å…¶ä»–æ¨¡æ¿`)\n                }\n                const response = await prompts({\n                    type: 'select',\n                    name: 'template',\n                    message: 'è¯·é€‰æ‹©é¡¹ç›®æ¨¡æ¿',\n                    choices: promptsConfig.templates,\n                    initial: 0, // é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ª\n                })\n                template = response.template\n            }\n\n            const tip = `åˆå§‹åŒ–é¡¹ç›® ${projectName}ï¼Œæ¨¡æ¿ ${template}`\n            const spinner = ora({\n                text: tip,\n                color: 'blue',\n                // spinner: 'growVertical',\n                // isEnabled: false\n            })\n            spinner.start()\n\n            const projectDir = path.resolve(cwd(), projectName)\n            if (fsExtra.existsSync(projectDir)) {\n                spinner.fail(`ğŸ’¥åˆå§‹åŒ–å¤±è´¥: é¡¹ç›®ç›®å½• ${projectName} å·²å­˜åœ¨`)\n                return\n            }\n\n            const res = await downloadTemplate(\n                `github:liaolonghui/react-nest-cli/packages/templates/${template}#main`,\n                {\n                    dir: projectDir,\n                }\n            )\n            const { dir } = res\n            spinner.succeed(`é¡¹ç›®åˆå§‹åŒ–æˆåŠŸï¼Œé¡¹ç›®ç›®å½•ï¼š${dir}`)\n        })\n}\n"],"mappings":";;;;;AACA,OAAO,aAAa;AAEpB,OAAO,aAAa;AACpB,OAAO,aAAa;AACpB,OAAO,UAAU;AACjB,SAAS,WAAW;AACpB,SAAS,wBAAwB;AACjC,OAAO,SAAS;AAED,SAAR,KAAsB,SAAkB;AAC3C,UACK,QAAQ,MAAM,EACd,YAAY,gCAAO,EACnB,SAAS,kBAAkB,0BAAM,EACjC,OAAO,8BAA8B,sCAAQ,EAC7C,OAAO,OAAO,aAAa,SAAS;AACjC,QAAI,EAAE,SAAS,IAAI,QAAQ,CAAC;AAE5B,QAAI,CAAC,aAAa;AACd,YAAM,WAAW,MAAM,QAAQ;AAAA,QAC3B,MAAM;AAAA,QACN,SAAS;AAAA;AAAA,QACT,MAAM;AAAA,QACN,SAAS;AAAA;AAAA,MAEb,CAAC;AACD,oBAAc,SAAS;AAAA,IAC3B;AAGA,UAAM,aACF,YACA,CAAC,uBAAc,UAAU,KAAK,CAAC,SAAS,KAAK,UAAU,QAAQ;AACnE,QAAI,CAAC,YAAY,YAAY;AACzB,UAAI,YAAY;AACZ,gBAAQ,MAAM,4BAAQ,QAAQ,iEAAe;AAAA,MACjD;AACA,YAAM,WAAW,MAAM,QAAQ;AAAA,QAC3B,MAAM;AAAA,QACN,MAAM;AAAA,QACN,SAAS;AAAA,QACT,SAAS,uBAAc;AAAA,QACvB,SAAS;AAAA;AAAA,MACb,CAAC;AACD,iBAAW,SAAS;AAAA,IACxB;AAEA,UAAM,MAAM,kCAAS,WAAW,sBAAO,QAAQ;AAC/C,UAAM,UAAU,IAAI;AAAA,MAChB,MAAM;AAAA,MACN,OAAO;AAAA;AAAA;AAAA,IAGX,CAAC;AACD,YAAQ,MAAM;AAEd,UAAM,aAAa,KAAK,QAAQ,IAAI,GAAG,WAAW;AAClD,QAAI,QAAQ,WAAW,UAAU,GAAG;AAChC,cAAQ,KAAK,qEAAiB,WAAW,qBAAM;AAC/C;AAAA,IACJ;AAEA,UAAM,MAAM,MAAM;AAAA,MACd,wDAAwD,QAAQ;AAAA,MAChE;AAAA,QACI,KAAK;AAAA,MACT;AAAA,IACJ;AACA,UAAM,EAAE,IAAI,IAAI;AAChB,YAAQ,QAAQ,iFAAgB,GAAG,EAAE;AAAA,EACzC,CAAC;AACT;","names":[]}